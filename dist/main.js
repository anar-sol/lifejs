(()=>{"use strict";class t{#t;#e;#n;#s;constructor(e,n){this.#t=e,this.#e=n,this.#n=t.#i(e,n),this.#s=null}static newLife(e,n){return new t(e,n)}static get CELL_STATE_ALIVE(){return!0}static get CELL_STATE_DEAD(){return!1}get columns(){return this.#t}get rows(){return this.#e}set onNextState(t){this.#s=t}setCellState([e,n],s){[e,n]=this.#o(e,n),t.#l(this.#n,e,n,s),this.#s&&this.#s(this)}toggleCellState([e,n]){const s=this.isCellAlive([e,n])?t.CELL_STATE_DEAD:t.CELL_STATE_ALIVE;this.setCellState([e,n],s)}isCellAlive([t,e]){return[t,e]=this.#o(t,e),this.#n[t][e]}nextState(){const e=t.#i(this.columns,this.rows);for(let n=0;n<this.columns;n++)for(let s=0;s<this.rows;s++){const i=this.#a(n,s);this.isCellAlive([n,s])&&(2===i||3===i)||!this.isCellAlive([n,s])&&3===i?t.#l(e,n,s,t.CELL_STATE_ALIVE):t.#l(e,n,s,t.CELL_STATE_DEAD)}this.#n=e,this.#s&&this.#s(this)}clear(){this.#n=t.#i(this.columns,this.rows),this.#s&&this.#s(this)}static#i(e,n){const s=new Array(e);for(let t=0;t<e;t++)s[t]=new Array(n);return t.#r(s),s}static#r(e){for(let n=0;n<e.length;n++)e[n].fill(t.CELL_STATE_DEAD)}static#l(t,e,n,s){t[e][n]=s}static#h(t,e,n,s){return t===n&&e===s}#o(t,e){return t>=this.columns&&(t%=this.columns),e>=this.rows&&(e%=this.rows),t<0&&(t=this.columns+t),e<0&&(e=this.rows+e),[t,e]}#a(e,n){let s=0;for(let i=e-1;i<=e+1;i++)for(let o=n-1;o<=n+1;o++)!t.#h(i,o,e,n)&&this.isCellAlive([i,o])&&s++;return s}}class e{#m;#c;#d;#C;#u;constructor(){this.#m=null,this.#c=null,this.#d=null,this.#C=null,this.onToggleCellCommand=null}static newView(){return new e}set onRunCommand(t){this.#m=t}set onPauseCommand(t){this.#c=t}set onNextCommand(t){this.#d=t}set onResetCommand(t){this.#C=t}set onToggleCellCommand(t){this.#u=t}runCommand(t){this.#m&&this.#m(t)}pauseCommand(){this.#c&&this.#c()}nextCommand(t){this.#d&&this.#d(t)}resetCommand(){this.#C&&this.#C()}toggleCellCommand([t,e]){this.#u&&this.#u([t,e])}update(){throw new Error("not implemented")}}class n{#g;#S;#w;constructor(t,e){e.onRunCommand=t=>{this.run(t)},e.onNextCommand=t=>{this.next(t)},e.onPauseCommand=()=>{this.pause()},e.onResetCommand=()=>{this.reset()},e.onToggleCellCommand=t=>{this.toggleCellState(t)},t.onNextState=()=>{this.update()},this.#g=t,this.#S=e,this.#w=null}static newController(t,e){return new n(t,e)}run(t){null==this.#w&&(this.#w=setInterval((()=>{this.next()}),1e3/t))}next(){this.#g.nextState?.()}pause(){clearInterval(this.#w),this.#w=null}reset(){this.pause(),this.#g.clear()}toggleCellState([t,e]){this.#g.toggleCellState([t,e])}update(){this.#S.update(this.#g)}}const s=t.newLife(130,75),i=new class extends e{#f={color:"black",background:"white",cellSize:10};#x;#v;constructor(){super(),this.init()}init(){const t=document.querySelector(".canvas-container"),e=document.querySelector(".canvas"),n=document.querySelector(".control-start"),s=document.querySelector(".control-next"),i=document.querySelector(".control-pause"),o=document.querySelector(".control-reset");e.width=t.clientWidth,e.height=t.clientHeight,this.#x=e,this.#v=e.getContext("2d"),n.addEventListener("click",(()=>{this.runCommand(5)})),s.addEventListener("click",(()=>{this.nextCommand()})),i.addEventListener("click",(()=>{this.pauseCommand()})),o.addEventListener("click",(()=>{this.resetCommand()})),e.addEventListener("click",(t=>{this.toggleCellCommand(this.#E(t.offsetX,t.offsetY))})),this.#L()}update(t){this.#L(),this.#A(t)}#E(t,e){return[Math.trunc(t/this.#f.cellSize),Math.trunc(e/this.#f.cellSize)]}#A(t){this.#v.fillStyle=this.#f.color;for(let e=0;e<t.columns;e++)for(let n=0;n<t.rows;n++){const s=e*this.#f.cellSize,i=n*this.#f.cellSize;t.isCellAlive([e,n])&&this.#T(s,i)}}#L(){this.#v.fillStyle=this.#f.background,this.#v.fillRect(0,0,this.#x.width,this.#x.height)}#T(t,e){this.#v.fillRect(t,e,this.#f.cellSize,this.#f.cellSize)}};n.newController(s,i)})();